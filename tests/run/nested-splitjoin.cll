
int@3->int@3 filter Halve() {
  work blocking {
    out(in() >> 1);
  }
}

int@4->int@4 filter Double() {
  work blocking {
    out(in() * 2);
  }
}

int->int splitjoin HalveOrDouble() {
  split@5 roundrobin();
  add Halve();
  add Double();
  join@6 roundrobin();
}

int@7->int@7 filter AddFive() {
  work blocking {
    out(in() + 5);
  }
}

int->int splitjoin Main() {
  split@1 roundrobin();
  add HalveOrDouble();
  add AddFive();
  join@2 roundrobin();
}

